---
import { toTagUrl } from '../lib/tags';

interface Props {
  title: string;
  description: string;
  published: Date;
  slug: string;
  tags?: string[];
  draft?: boolean | "placeholder";
}

const { title, description, published, slug, tags = [], draft } = Astro.props;

const formattedDate = published.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
}); 
---

<article class="py-8" transition:name={`post-${slug}`}>
  <a href={`/posts/${slug}`} class="relative group no-underline block">
    {draft && (
      <span transition:name={`post-${slug}-draft`} class="absolute -left-20 top-[0.5lh] font-(family-name:--font-ui) text-xs font-bold uppercase tracking-widest px-2 py-0.5 rounded bg-amber-400 text-amber-950 hidden lg:block">
        {draft === "placeholder" ? "Placeholder" : "Draft"}
      </span>
    )}
    <h2
      transition:name={`post-title-${slug}`}
      class="text-2xl sm:text-3xl font-semibold leading-tight text-(--color-text) m-0 mb-2 group-hover:text-(--color-accent-interactive) transition-colors"
    >
      {draft && <span class="sr-only">[Draft] </span>}{title}
    </h2>
  </a>
  <div class="flex items-center gap-3 mb-3">
    <time datetime={published.toISOString()} class="font-(family-name:--font-ui) text-sm text-(--color-muted)">
      {formattedDate}
    </time>
    {tags.length > 0 && (
      <>
        <span class="text-(--color-border)">Â·</span>
        <div class="flex gap-2">
          {tags.map((tag) => (
            <a href={toTagUrl(tag)} class="font-(family-name:--font-ui) text-xs text-(--color-muted) tracking-wide no-underline hover:text-(--color-accent-interactive) transition-colors">
              {tag}
            </a>
          ))}
        </div>
      </>
    )}
  </div>
  <p class="font-(family-name:--font-body) text-base text-(--color-muted) leading-relaxed m-0">
    {description}
  </p>
</article>
